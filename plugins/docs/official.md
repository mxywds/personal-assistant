# 悟空的官方插件

## LocalPlayer

本地音乐播放器。


### 触发条件

指令中包含 “本地音乐” 关键词。

### 常用指令

| 指令 | 相同指令  |  用途 |
| ---- | -------- | ----- |
| 播放本地音乐 | -    | 开始播放指定目录下的音乐。 |
| 下一首 | 下一首歌, 下首歌   | 切换到下一首歌。如果没有下一首歌，就回到列表中第一首歌 |
| 上一首 | 上一首歌，上首歌 | 切换到上一首歌。如果没有上一首歌，就跳到列表中最后一首歌 |
| 停止播放 | 结束播放/退出播放 | 停止播放音乐的播放 |
| 大声点   | 大声一点，调大音量  | 调大音量 |
| 小声点    | 小声一点，调小音量   | 调小音量  |

### 示例

- 用户：“播放本地音乐”
- 悟空：开始播放指定目录下的音乐

### 配置

``` yaml
## 本地音乐插件
LocalPlayer:
    path: "/Users/panweizhou/Music"  # 本地音乐存放路径
```

?> 特别注意：如果使用自定义的 UNIT 账号，需要确保在百度 UNIT 账号里已经添加了百度预置的音乐技能。<br>
  方法：登录百度 UNIT ，在机器人设置里点击添加技能按钮：<br>
  ![添加图片](https://hahack-1253537070.file.myqcloud.com/uPic/addkill.png)<br>
  然后找到音乐预置技能，然后点击底部的“已选择1个技能，添加至机器人”，完成技能添加：<br>
  ![添加图片](http://hahack-1253537070.file.myqcloud.com/uPic/addskill-2.png)

## Reminder

日程提醒插件。支持定时提醒和周期提醒。

### 触发条件

当检测到用户的问题包含 `CHECK_REMIND` （检查提醒）， `DELETE_REMIND`（删除提醒）或 `SET_REMIND` （设置提醒） 的意图时。

当时间到了之后，会循环播放指定次数（默认3次）的语音提醒。

### 示例

#### 设置定时提醒

- 用户：10分钟后提醒我吃饭。
- 悟空：好的，已为您添加提醒：时间：2023-03-26|13:05:54，事项：吃饭。

#### 设置周期提醒

- 用户：每周一上午7点半提醒我起床。
- 悟空：好的，已为您添加提醒：时间：每周一上午七点半, 事项：起床。

#### 检查提醒

- 用户：我有多少个提醒？
- 悟空：您当前有2个提醒。第1个提醒内容是时间：2023-03-26|13:05:54，事项：吃饭。第2个提醒内容是时间：每周一上午七点半, 事项：起床。

#### 删除提醒

- 用户：删除提醒。
- 悟空：您当前有2个提醒。第1个提醒内容是时间：2023-03-26|13:05:54，事项：吃饭。第2个提醒内容是时间：每周一上午七点半, 事项：起床。要删除哪个提醒呢？
- 用户：第二个。
- 悟空：好的，已删除该提醒。

### 配置

``` yaml
# 提醒功能
reminder:
    repeat: 3  # 语音重复次数
```

?> 特别注意：如果使用自定义的 UNIT 账号，需要确保在百度 UNIT 账号里已经添加了百度预置的提醒技能。方法同 [LocalPlayer-配置](official?id=配置) ，不再赘述。<br>

## Email

检查邮件功能。

### 触发条件

1. 用户已在 ~/.wukong/config.xml 中完成了邮箱的配置。
2. 指令中有关键词 “邮件” 。

语音播报的规则：
- 如果配置 `read_email_title` 选项为 `true`，会同时阅读邮件标题。如果为 `false`，则只阅读邮件的发件人信息。
- 如果邮件的标题带有 `[echo]` 的前缀，则不管 `read_email_title` 值为什么，都会阅读该邮件的标题，并且不会播报发件人信息（可利用该功能来实现传话、其他事件监控播报，例如与 ifttt 结合发布各类通知）。
- 如果邮件的标题带有 `[control]` 的前缀，且发件人是用户的邮箱，则将当成一条远程命令指令进行响应。

### 示例

- 用户：“我有多少封邮件？”
- 悟空：“您有一封来自 m at hahack.com 的未读邮件”

### 特别说明 ###

国内的一些邮件服务使用的是私有协议（例如 QQ 邮箱），所以 Email 插件是无法适用的。

目前测试比较好的是网易邮箱。如果使用网易邮箱，还需设置允许第三方客户端收发邮件：

?> <http://config.mail.163.com/settings/imap/index.jsp?uid=您的邮箱地址>

注意把链接中 `您的邮箱地址` 改为您真实的网易邮箱地址（带邮箱后缀）。

另外，网易邮箱还需设置开启 IMAP/SMTP服务和 POP3/SMTP 服务，并添加授权密码作为邮箱密码添加到 config.yml 中。详见下图：

![](https://hahack-1253537070.cos.ap-chengdu.myqcloud.com/images/wukong-docs/netease-email-config.png)

## Camera

用于调起摄像头拍照（如果安装了摄像头的话）。拍完后将在后台管理端的会话气泡中直接展示。

### 适用平台

适用于树莓派、带有USB摄像头的 PC 或者 Mac。

### 触发条件

指令中有关键词 “拍照” 或 “拍张照” 时。

如果接入了邮箱，照片将发送到用户的邮箱中。

### 示例

#### 倒计时拍照

- 用户：“拍张照”。
- 悟空：“收到，3秒后启动拍照……咔擦（拍照声）……拍照成功！正在发送照片到您的微信……发送成功！”

#### 无声拍照

- 用户：“偷偷地拍张照”（也可以使用微信发）。
- 悟空：“……（无声）”

### 配置

``` yaml
# 后台管理端
server:
    ...
    host: '0.0.0.0'  # 这里改成当前运行 wukong-robot 的设备的局域网地址
    ...

...

# 拍照
# 需接入摄像头才能使用
camera:
    enable: false
    type: 2                 # 摄像头类型 0：usb_camera，1：树莓派 5MP 摄像头，2：Mac 摄像头
                            # 对于 Mac 摄像头，请先安装 imagesnap 。例如 Mac OSX： brew install imagesnap
    dest_path: "/Users/panweizhou/Pictures/" # 保存目录
    quality: 5              # 成像质量（0~100），不支持 imagesnap
    vertical_flip: true     # 竖直翻转，不支持 imagesnap
    horizontal_flip: false  # 水平翻转，不支持 imagesnap
    count_down: 3           # 倒计时（秒），仅当开启倒计时时有效
    sound: true             # 是否有拍照音效
    usb_camera: false       # 是否是 USB 摄像头（已废弃，请使用 type）
```

如果是 USB 摄像头，还需要确保安装了 fswebcam ：

``` bash
sudo apt-get install fswebcam
```

如果是树莓派摄像头，请确保在 `raspi-config` 中已启用 Camera ：

![](https://images2015.cnblogs.com/blog/1174662/201705/1174662-20170531164041180-332981382.jpg)

如果是 Mac OSX 摄像头，则需要安装 imagesnap ：

``` bash
brew install imagesnap
```

## CleanCache

用于清除 wukong-robot 运行时产生的所有临时数据（包括语音缓存数据）

### 触发条件

指令中有关键词 “清除缓存” 或 “清空缓存”

### 示例

- 用户：“清除缓存”
- 悟空：“缓存目录已清空”

## Poem

让 wukong-robot 给你写一首诗

### 触发条件

指令中有关键词 “写诗”

### 示例

- 用户：“写一首关于大海的诗"
- 悟空：“神州大海起风浪,诗友词坛聚一堂,我自天涯歌盛世,君从塞外写华章”
- 用户：“写诗”
- 悟空：“曾写诗行几度秋,酸甜苦辣共登楼,谁言此地无春色,我自吟哦乐不休”

## Echo

简单的回声/传话功能。

当借助 [wukong-qq-guild](https://github.com/wzpan/wukong-qq-guild) 接入频道机器人时，可以利用这个功能实现远程给家里发语音消息。

### 触发条件

当检测到指令中包含 "echo" 或者 "传话" 时，将其余内容直接念出来。

### 示例

- 用户：“echo 你是最棒的”
- 悟空：“你是最棒的”

## Volume

音量控制功能。可以让 wukong-robot 调节音量。

### 触发条件

当检测到用户的问题符合 `CHANGE_VOL` 意图时。

### 示例

- 用户：调大音量
- 悟空：好的
- 用户：小声一点
- 悟空：好的

## Geek（极客模式） ##

类似 DuerOS 的极客模式。用于免唤醒实现和 wukong-robot 交互。当超过 5 轮用户没有说出指令时，自动结束极客模式。

!> 已知问题：Mac 中使用极客模式可能会有卡住的情况。原因是 PyAudio 在短时间内频繁进入录音时可能出现内存泄漏。如果遇到，需要重新启动 wukong-robot 。

### 触发条件

指令中含有关键词 “进入极客模式” 。

### 常用指令 ###

| 指令 | 相同指令  |  用途 |
| ---- | -------- | ----- |
| 进入极客模式 | 开启极客模式，激活极客模式，打开极客模式     | 进入极客模式  |
| 退出极客模式   | 结束极客模式，停止极客模式           | 退出极客模式。也可以保持一段时间不说指令，之后自动结束极客模式。     |

### 示例

- 用户：“进入极客模式”
- 悟空：“进入极客模式”
- 用户：“你叫什么名字”
- 悟空：“我叫悟空”
- 用户：“你爸爸是谁”
- 悟空：“我爸爸是潘伟洲”
- 用户：“退出极客模式”
- 悟空：“退出极客模式”

## Gossip

闲聊模式。当你只想跟机器人进行纯聊天时，可以打开这个模式。

在这个模式下，将不会匹配任何技能，直接把问题交给聊天机器人进行兜底。这样可以节省一点技能匹配的时间。

### 触发条件

当检测到指令中包含 "闲聊一下" / "进入闲聊" / "结束闲聊" / "退出闲聊" 时。

### 示例

- 用户：“闲聊一下”
- 悟空：“好的，已进入闲聊模式”
- 用户：“今天天气怎么样”
- 悟空：作为 AI，我无法直接感知天气。请告诉我您现在所处的地理位置，我可以为您查询当地的天气情况。
- 用户：“结束闲聊”
- 悟空：“结束闲聊”
- 用户：“今天天气怎么样”
- 悟空：深圳天气：今天：多云，19到22摄氏度。